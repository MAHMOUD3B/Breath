<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HPI | اتشيك اوت</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&family=Cairo:wght@200;300;400;500;600&family=Comfortaa:wght@300;400;500&family=Poppins:wght@200;300;400;500;600;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="./css/all.min.css" />
  <link rel="stylesheet" href="./css/bootstrap.rtl.min.css" />
  <link rel="stylesheet" href="./css/style.css" />
  <link rel="stylesheet" href="./css/offers.css" />
  <link rel="stylesheet" href="./css/responsive.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="icon" type="image/png" href="./img/HPI logotest.png" />

  <!-- Meta Pixel Code -->
  <script>
    !function (f, b, e, v, n, t, s) {
      if (f.fbq) return; n = f.fbq = function () {
        n.callMethod ?
          n.callMethod.apply(n, arguments) : n.queue.push(arguments)
      };
      if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
      n.queue = []; t = b.createElement(e); t.async = !0;
      t.src = v; s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1166419688986879');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=1166419688986879&ev=PageView&noscript=1" /></noscript>
  <!-- End Meta Pixel Code -->

  <!-- TikTok Pixel Code Start -->
  <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject = t; var ttq = w[t] = w[t] || []; ttq.methods = ["page", "track", "identify", "instances", "debug", "on", "off", "once", "ready", "alias", "group", "enableCookie", "disableCookie", "holdConsent", "revokeConsent", "grantConsent"], ttq.setAndDefer = function (t, e) { t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } }; for (var i = 0; i < ttq.methods.length; i++)ttq.setAndDefer(ttq, ttq.methods[i]); ttq.instance = function (t) {
        for (
          var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++)ttq.setAndDefer(e, ttq.methods[n]); return e
      }, ttq.load = function (e, n) {
        var r = "https://analytics.tiktok.com/i18n/pixel/events.js", o = n && n.partner; ttq._i = ttq._i || {}, ttq._i[e] = [], ttq._i[e]._u = r, ttq._t = ttq._t || {}, ttq._t[e] = +new Date, ttq._o = ttq._o || {}, ttq._o[e] = n || {}; n = document.createElement("script")
          ; n.type = "text/javascript", n.async = !0, n.src = r + "?sdkid=" + e + "&lib=" + t; e = document.getElementsByTagName("script")[0]; e.parentNode.insertBefore(n, e)
      };


      ttq.load('D41N013C77U7N6DP72RG');
      ttq.page();
    }(window, document, 'ttq');
  </script>
  <!-- TikTok Pixel Code End -->
</head>

<body>
  <!-- Top Bar Start -->
  <header class="top-bar">
    <div class="container d-none d-md-block">
      <div class="row">
        <div class="col-6 top-bar-social">
          <ul class="list-unstyled">
            <li>
              <a target="_blank" href="https://www.facebook.com/profile.php?id=61580457038298"><i
                  class="fa-brands fa-facebook-f"></i></a>
            </li>
            <li>
              <a href="https://wa.me/201126330025" target="_blank">
                <i class="fa-brands fa-whatsapp"></i>
              </a>
            </li>
            <li>
              <a target="_blank" href="https://www.instagram.com/breathhpi/ "><i class="fa-brands fa-instagram"></i></a>
            </li>
            <li>
              <a target="_blank" href="https://www.tiktok.com/@breathhpi"><i class="fa-brands fa-tiktok"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </header>
  <!-- Top Bar End -->

  <!--Navbar start-->
  <nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top">
    <div class="container">
      <a class="navbar-brand" href="/index en.html"><img src="./img/Logo.png" alt="" /></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav m-auto mb-2 mb-lg-0 justify-content-center">
          <li class="nav-item">
            <a class="nav-link" href="/index en.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index en.html#AboutUs">About-product</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="offers en.html">offers</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="how-to-use en.html">usage</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="usage-induction en.html">
              Indications for use
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="index en.html#contactUs">Contact-us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="cheakout.html">العربية</a>
          </li>
        </ul>
        <div class="d-flex align-items-center">
          <a href="checkout-en.html" class="btn btn-lg order-now-btn d-none d-md-block" role="button"
            aria-pressed="true">Order now</a>
        </div>
      </div>
    </div>
  </nav>
  <!--Navbar End-->

  <!-- Offers buttons Start -->
  <section class="offers-btns my-5">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <a href="offers%20en.html#Individual" id=" Individual" class="offers-btn w-100">
            Individual offers
          </a>
        </div>
        <div class="col-md-6">
          <a href="offers%20en.html#Quantity" class="offers-btn w-100">
            Quantity offers
          </a>
        </div>
      </div>
    </div>
  </section>
  <!-- Offers buttons End -->

  <!--contact us start-->
  <section class="contact-us">
    <div class="container">
      <div class="section-title">
        <h3>Contact us to place an order</h3>
        <p>
          Please enter your data correctly to receive your order as soon as
          possible
        </p>
      </div>
      <div class="contact-us-content" id="buy">
        <div class="row">     
          <div class="col-lg-8">
            <div class="contact-form">
              <p class="offer-message text-center"></p>
              <div class="row p-2">
                <div class="col-md-6 form-group">
                  <label for="qty"> Number of pieces</label>
                  <input type="number" class="form-control fs-4" id="qty" min="1" placeholder="Enter number of Pieces" required />
                </div>
                <div class="col-md-6 form-group">
                  <label for="total">Total After Discount</label>
                  <input type="text" class="form-control text-dark fs-4" readonly disabled id="total" />
                </div>
              </div>
              <hr />
              <h4 class="sttitle">Order now</h4>
              <form id="orderForm" novalidate>
                <div id="formError" class="form-error"
                  style="display:none;color:#dc3545;margin-bottom:10px;font-weight:600;"></div>
                <div class="row">
                  <div class="col-md-6 form-group">
                    <label for="firstname">Customer name</label>
                    <input type="text" class="form-control" id="firstname" placeholder=" Customer name" />
                    <div class="invalid-feedback">Enter the name.</div>
                  </div>
                  <div class="col-md-6 form-group">
                    <label for="phone"> Mobile number</label>
                    <input type="text" class="form-control" id="phone" placeholder=" Please enter a mobile number." />
                    <div class="invalid-feedback">
                      Please enter a valid phone number
                    </div>
                  </div>
                  <div class="col-md-6 form-group">
                    <label for="phone">
                      Alternative mobile number (optional)</label>
                    <input type="text" class="form-control" id="phone1" placeholder=" Please enter a mobile number." />
                    <div class="invalid-feedback">
                      Please enter a valid phone number
                    </div>
                  </div>
                  <div class="col-md-6 form-group">
                    <label for="phone"> Governorate</label>
                    <select type="text" class="form-control" id="inputGroupSelect01">
                      <option selected>Select Governorate ..</option>
                      <option value="cairo">Cairo</option>
                      <option value="qaliubiya">Qalyubia</option>
                      <option value="giza">Giza</option>
                      <option value="alexandria">Alexandria</option>
                      <option value="sharqia">Sharqia</option>
                      <option value="dakahlia">Dakahlia</option>
                      <option value="gharbia">Gharbia</option>
                      <option value="beheira">Beheira</option>
                      <option value="damietta">Damietta</option>
                      <option value="port-said">Port Said</option>
                      <option value="suez">Suez</option>
                      <option value="ismailia">Ismailia</option>
                      <option value="matrouh">Matrouh</option>
                      <option value="fayoum">Fayoum</option>
                      <option value="bani-suef">Beni Suef</option>
                      <option value="minya">Minya</option>
                      <option value="assiut">Assiut</option>
                      <option value="sohag">Sohag</option>
                      <option value="qena">Qena</option>
                      <option value="luxor">Luxor</option>
                      <option value="aswan">Aswan</option>
                      <option value="red-sea">Red Sea</option>
                      <option value="new-valley">New Valley</option>
                      <option value="north-sinai">North Sinai</option>
                      <option value="south-sinai">South Sinai</option>
                      <option value="monufia">Monufia</option>
                    </select>
                  </div>
                  <div class="col-md-6 form-group">
                    <label for="area">Residential area</label>
                    <input type="text" class="form-control" id="area" placeholder=" Residential area" />
                    <div class="invalid-feedback">
                      Enter the residential area.
                    </div>
                  </div>
                  <div class="col-md-6 form-group">
                    <label for="exampleFormControlTextarea1">Address in detail</label>
                    <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
                      placeholder="Enter Address in detail."></textarea>
                    <div class="invalid-feedback">
                      Enter the residential area.
                    </div>
                  </div>
                  <h4 class="payment-title">Payment</h4>

                  <div class="col-md-6 payment-ways">
                    <div class="form-check">
                      <input type="radio" class="form-check-input" id="method1" name="redirect" checked="true"
                        value="no-link" onclick="show1();" />
                      <label for="method1" class="form-check-label1"><img src="./img/house.png" alt="" /> Payment on
                        delivery</label>
                    </div>
                  </div>
                  <div class="col-md-6 payment-ways">
                    <div class="form-check">
                      <input type="radio" class="form-check-input" id="method2" name="redirect" onclick="show1(); "
                        value="no-link" />
                      <label for="method2" class="form-check-label"><img src="./img/voda.png" alt="" />
                        vodafone-cash</label>
                    </div>
                  </div>
                  <div class="col-md-6 payment-ways">
                    <div class="form-check">
                      <input type="radio" class="form-check-input" id="method3" name="redirect" onclick="show1(); "
                        value="no-link" />
                      <label for="method3" class="form-check-label"><img src="./img/insta.png" alt="" />
                        Insta-pay</label>
                    </div>
                  </div>
                  <div class="col-md-6 payment-ways">
                    <div class="form-check">
                      <input type="radio" class="form-check-input" id="method4" name="redirect" onclick="show2();"
                        value="no-link" required />
                      <label for="method4" class="form-check-label2"><img src="./img/visa.png" alt="" />
                        Visa-card</label>
                    </div>
                  </div>
                </div>
                <button type="submit" class="btn btn-checkout mx-auto d-block" data-target="/thankyou en.html">Click to complete your
                purchase</button>
              </form>
            </div>
          </div>
          <div class="col-lg-4" id="contactUs">
            <div class="contact-info">
              <div class="cont-info-title">
                <h4>Contact us</h4>
                <p>
                  Stay in touch with us and follow us to receive all the
                  latest news.
                </p>
              </div>

              <div class="contact-field"></div>
              <div class="contact-field">
                <div class="cont-icon">
                  <img src="./img/email.png" alt="" />
                </div>
                <div class="cont-txt">
                  <h5>e-mail</h5>
                  <p>Inf@hpi-eg.com</p>
                </div>
              </div>
              <div class="contact-field">
                <div class="cont-icon">
                  <img src="./img/phone.png" alt="" />
                </div>
                <div class="cont-txt">
                  <h5>Contact us via:</h5>
                  <p>01126330025</p>
                </div>
              </div>
              <hr />
              <div class="adrees">
                <div class="adrees-top">
                      <!-- ايكون السوشيال ميديا  -->
                  <div class="social">
                    <a href="https://www.facebook.com/profile.php?id=61580457038298" target="_blank"><i
                        class="fa-brands fa-facebook-f"></i></a>
                    <a href="https://wa.me/201126330025" target="_blank"><i class="fa-brands fa-whatsapp"></i></a>
                    <a href="https://www.instagram.com/breathhpi/ " target="_blank"><i
                        class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@breathhpi" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                  </div>

                </div>

                <div class="image">
                  <img src="/img/hpi logo.png" alt="HPI logo" width="100">
                </div>
                <div class="hpi">
                  <span>Hendy for pharmaceutical industries</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
  </section>
  <!-- Contact Us Ends-->

  <!-- Confirm Order Modal Start-->
  <div id="confirmModal" class="confirm-modal" aria-hidden="true">
    <div class="confirm-backdrop"></div>
    <div class="confirm-dialog" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <button class="confirm-close" type="button" aria-label="Close">&times;</button>
      <h5 id="confirmTitle" class="confirm-title">Confirm your details before completing</h5>
      <div class="confirm-body">
        <ul class="confirm-list" id="confirmList">
          <!-- Filled by JS -->
        </ul>
        <p class="confirm-note">Please review your details carefully. You can edit them before confirming.</p>
      </div>
      <div class="confirm-actions">
        <button type="button" class="btn btn-edit" id="btnEdit">Edit details</button>
        <button type="button" class="btn btn-confirm" id="btnConfirm">Confirm order</button>
      </div>
    </div>
  </div>
  <!-- Confirm Order Modal End-->

  <!--footer start-->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <div class="footer-field">
            <div class="footer-icon">
              <img src="./img/footer1.png" alt="photo image" />
            </div>
            <div class="footer-txt">
              <button type="button" class="btn footerlink" data-bs-toggle="modal" data-bs-target="#privacyModal">
                سياسة الخصوصية
              </button>
              <div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="privacyModalLabel">
                        سياسة الخصوصية
                      </h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <h4>سياسة الخصوصية</h4>
                      <p>
                        نحترم خصوصيتك. نجمع بيانات أساسية لإتمام الطلب والشحن والدعم (الاسم، العنوان، الهاتف، البريد).
                        لا نخزّن بيانات البطاقة؛ تتم عبر مزوّد دفع آمن. نستخدم كوكيز للتحسين فقط، ونشارك البيانات مع
                        شركاء الشحن والدفع عند الحاجة. لطلب الوصول أو الحذف: [email].
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="footer-field">
            <div class="footer-icon">
              <img src="./img/footer2.png" alt="شروط الاستخدام" />
            </div>
            <div class="footer-txt">
              <button type="button" class="btn footerlink" data-bs-toggle="modal" data-bs-target="#termsModal">
                شروط الاستخدام
              </button>

              <!-- ملاحظات: id و aria-labelledby متطابقان مع الزر -->
              <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="termsModalLabel">شروط الاستخدام</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق"></button>
                    </div>
                    <div class="modal-body">
                      <h4>شروط الاستخدام</h4>
                      <p>
                        يُستخدم منتج بريث لتخفيف أعراض الجيوب الأنفية وتحسين التنفس.
                        يجب الالتزام بطريقة الاستعمال الموصى بها وعدم استخدامه كبديل للعلاج الطبي.
                        الشركة غير مسؤولة عن أي أضرار ناتجة عن سوء الاستخدام أو تجاهل التعليمات.
                      </p>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>


        <div class="col-lg-3">
          <div class="footer-field">
            <div class="footer-icon">
              <img src="./img/footer3.png" alt="" />
            </div>
            <div class="footer-txt">
              <button type="button" class="btn footerlink" data-bs-toggle="modal" data-bs-target="#privacyModal2">
                الاستبدال و الاسترجاع
              </button>
              <div class="modal fade" id="privacyModal2" tabindex="-1" aria-labelledby="privacyModalLabel2"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="privacyModalLabel2">
                        سياسة الاستبدال
                      </h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <h4>سياسة الاستبدال </h4>
                      <p> نقبل الاسترجاع/الاستبدال خلال 14 يومًا للمنتجات غير المفتوحة والمختومة فقط حفاظًا على الصحة.
                        في حال وصول منتج تالف أو خاطئ، نستبدله أو نرد المبلغ دون رسوم شحن إضافية عند الإبلاغ خلال 48
                        ساعة.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="footer-field">
            <div class="footer-icon">
              <img src="./img/feat3.png" alt="" />
            </div>
            <div class="footer-txt">
              <button type="button" class="btn footerlink" data-bs-toggle="modal" data-bs-target="#privacyModal3">
                سياسة الشحن
              </button>
              <div class="modal fade" id="privacyModal3" tabindex="-1" aria-labelledby="privacyModalLabel3"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="privacyModalLabel3">
                        سياسة الشحن
                      </h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <h4>سياسة الشحن</h4>
                      <p>
                        نُجهّز الطلب خلال 1–2 يوم عمل ونُرسل داخل جمهورية مصر العربية فقط. عادةً يصل الشحن خلال 1–3 أيام
                        داخل القاهرة والجيزة و2–5 أيام لباقي المحافظات. تُحسب تكلفة الشحن وتظهر عند الدفع، ويتوفر تتبّع
                        للطلب. في حال فشل التسليم بسبب عنوان غير دقيق أو عدم تواجد المستلم قد تُعاد الشحنة وتُطبق رسوم
                        إعادة الشحن. لطلب تعديل العنوان يُرجى التواصل قبل الشحن.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!--footer Ends-->

  <!-- Scripts files -->
  <script src="./js/all.min.js"></script>
  <script src="https://use.fontawesome.com/1744f3f671.js"></script>
  <script src="./js/bootstrap.bundle.min.js"></script>
  <script src="/js/main.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // عناصر الفورم
      const firstname = document.getElementById("firstname");
      const phone = document.getElementById("phone");
      const phoneAlt = document.getElementById("phone1");
      const governorate = document.getElementById("inputGroupSelect01");
      const area = document.getElementById("area");
      const address = document.getElementById("exampleFormControlTextarea1");
      const qty = document.getElementById("qty");
      const total = document.getElementById("total");
      const form = document.getElementById('orderForm');
      const btnCheckout = document.querySelector(".btn.btn-checkout");

      // طرق الدفع (نفس IDs عندك)
      const methodRadios = Array.from(document.querySelectorAll('input[name="redirect"]'));
      const paymentLabelById = {
        "method1": "Cash on delivery",
        "method2": "Vodafone Cash",
        "method3": "Insta-pay",
        "method4": "Visa / MasterCard"
      };

      // عناصر البوب-أب
      const modal = document.getElementById("confirmModal");
      const list = document.getElementById("confirmList");
      const btnConfirm = document.getElementById("btnConfirm");
      const btnEdit = document.getElementById("btnEdit");
      const btnClose = modal.querySelector(".confirm-close");

      // فتح / قفل المودال + إدارة التركيز وتحسينات الوصول
      let _lastFocused = null;
      const openModal = () => {
        _lastFocused = document.activeElement;
        modal.classList.add("show");
        modal.setAttribute('aria-hidden', 'false');
        // focus first actionable element
        const confirmBtn = document.getElementById('btnConfirm');
        if (confirmBtn) confirmBtn.focus();
      };
      const closeModal = () => {
        modal.classList.remove("show");
        modal.setAttribute('aria-hidden', 'true');
        if (_lastFocused && typeof _lastFocused.focus === 'function') _lastFocused.focus();
      };

      btnClose.addEventListener("click", closeModal);
      btnEdit.addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal || e.target.classList.contains("confirm-backdrop")) closeModal();
      });

      // التحقق الأساسي قبل العرض (بسيط وخفيف)
      function validateRequired() {
        let ok = true;
        const requiredFields = [
          [firstname, "ادخل الاسم."],
          [phone, "برجاء ادخال رقم هاتف صحيح"],
          [governorate, "اختر المحافظة."],
          [area, "ادخل المنطقة السكنية."],
          [address, "ادخل العنوان بالتفصيل."],
          [qty, "ادخل عدد القطع."]
        ];

        requiredFields.forEach(([el]) => el.classList.remove("is-invalid"));

        requiredFields.forEach(([el]) => {
          const val = (el.value || "").trim();
          const invalid = !val || (el === governorate && (el.selectedIndex === 0));
          if (invalid) {
            el.classList.add("is-invalid");
            ok = false;
          }
        });
        // إذا كانت طريقة الدفع بفيزا/ماستر كارد، اجعل حقول البطاقة مطلوبة
        if (document.getElementById('method4') && document.getElementById('method4').checked) {
          const cardFields = [
            [document.getElementById('card-name'), 'Name on card required'],
            [document.getElementById('card-no'), 'Card number required'],
            [document.getElementById('card-exp'), 'End date required'],
            [document.getElementById('card-cvc'), 'Security code required']
          ];
          cardFields.forEach(([el]) => {
            el.classList.remove('is-invalid');
            const val = (el.value || '').trim();
            if (!val) {
              el.classList.add('is-invalid'); ok = false;
            }
          });
        }
        if (!ok) {
          // اسكرول لأول عنصر غير صالح
          const firstInvalid = document.querySelector(".is-invalid");
          if (firstInvalid) firstInvalid.scrollIntoView({ behavior: "smooth", block: "center" });
        }
        return ok;
      }

      // تكوين عناصر العرض في البوب-أب
      function buildRows(data) {
        list.innerHTML = "";
        const entries = [
          ["Customer name", data.name],
          ["Mobile number", data.phone],
          ["Alternative mobile", data.phoneAlt || "—"],
          ["Governorate", data.gov],
          ["Residential area", data.area],
          ["Address", data.address],
          ["Payment method", data.payment],
          ["Quantity", data.qty],
          ["Total after discount", data.total]
        ];
        for (const [k, v] of entries) {
          const li = document.createElement("li");
          const key = document.createElement("div"); key.className = "k"; key.textContent = k;
          const val = document.createElement("div"); val.className = "v"; val.textContent = String(v || "").trim();
          li.appendChild(key); li.appendChild(val);
          list.appendChild(li);
        }
      }

      // Toggle card fields visibility when payment method changes
      //const cardInfo = document.getElementById('card-info1');
      /*function toggleCardInfo() {
        const show = document.getElementById('method4') && document.getElementById('method4').checked;
        if (cardInfo) {
          cardInfo.style.display = show ? 'flex' : 'none';
          cardInfo.setAttribute('aria-hidden', show ? 'false' : 'true');
        }
      }*/
      //methodRadios.forEach(r => r.addEventListener('change', toggleCardInfo));
      // initial state
      //toggleCardInfo();

      // API Base URL
      const API_BASE_URL = 'https://api.breath.hpi-eg.com';

      // Handle Cash on Delivery Payment
      async function handleCodPayment(orderData) {
        try {
          const response = await fetch(`${API_BASE_URL}/api/payments/cod`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json',
            },
            body: JSON.stringify(orderData)
          });

          console.log('Response status:', response.status);
          const result = await response.json();
          console.log('API Response:', result);

          if (response.ok && result.success) {
            window.location.href = '/thankyou en.html';
          } else {
            alert('Error sending order: ' + (result.error || 'Unknown error'));
          }
        } catch (error) {
          console.error('Error sending order:', error);
          alert('Error sending order: ' + error.message);
        }
      }

      // Handle Wallet Payment (Vodafone Cash, Instapay, Visa)

      /*
      async function handleWalletPayment(orderData) {
        try {
          console.log('Attempting wallet payment:', orderData);

          const response = await fetch(`${API_BASE_URL}/api/payments/wallet`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
            },
            body: JSON.stringify(orderData),
          });

          const result = await response.json();

          if (!response.ok || !result.success) {
            throw new Error(result.error || "Payment creation failed.");
          }

          // Handle different wallet payment responses
          console.log('Payment response:', result);

          if (result.payment_method === "iframe") {
            // Show iframe URL for card payment
            console.log('Iframe URL:', result.data.iframe_url);
            alert('You will be redirected to the payment page. URL: ' + result.data.iframe_url);
            window.location.href = result.data.iframe_url;
          } else if (result.payment_method === "mobile_wallet") {
            // Mobile wallet - user will receive notification on phone
            console.log('Mobile wallet payment initiated');
            alert(
              "A payment request has been sent to your phone. Please enter your PIN to confirm the transaction."
            );
          }
        } catch (error) {
          alert(`Error occurred: ${error.message}`);
          console.error("Wallet Payment error:", error);
          throw error;
        }
      }
      */
     
      // Handle form submit instead of relying on an anchor
      form.addEventListener('submit', (e) => {
        e.preventDefault();

        // basic validation
        if (!validateRequired()) return;

        // determine payment label and method
        const selected = methodRadios.find(r => r.checked);
        const paymentText = selected ? (paymentLabelById[selected.id] || "—") : "—";
        const selectedPaymentMethod = selected ? selected.id : null;

        // prepare data for modal preview
        const data = {
          name: firstname.value.trim(),
          phone: phone.value.trim(),
          phoneAlt: phoneAlt.value.trim(),
          gov: (governorate.options[governorate.selectedIndex] || {}).text || "",
          area: area.value.trim(),
          address: address.value.trim(),
          payment: paymentText,
          qty: qty.value || "1",
          total: (total && total.value) ? total.value : "—"
        };

        buildRows(data);
        openModal();

        // When user confirms — send order to API with proper payment method handling
        const onConfirm = async () => {
          closeModal();

          // Prepare customer data
          const customerData = {
            first_name: data.name.split(' ')[0],
            last_name: data.name.split(' ').slice(1).join(' ') || 'NA',
            phone_number: data.phone,
            full_address: {
              apartment: "NA",
              floor: "NA",
              street: data.address,
              building: "NA",
              postal_code: "NA",
              city: data.area,
              country: "EG",
              state: data.gov
            }
          };

          // Prepare order data
          const orderData = {
            amount: Number(data.total),
            amount_cents: Number(data.total) * 100,
            quantity: Number(data.qty),
            currency: "EGP",
            wallet_type: "CASH",
            wallet_display_name: "CASH",
            payment_method: "cash_on_delivery",
            customer: customerData
          };

          try {
            switch (selectedPaymentMethod) {
              case "method1": // Cash on Delivery
                await handleCodPayment(orderData);
                break;

              case "method4": // Visa Card
                orderData.wallet_type = "CARD";
                orderData.payment_method = "card";
                await alert("Payment methods not available now, try cash on delivary.");
                break;

              case "method2": // Vodafone Cash
                orderData.wallet_type = "VODAFONE_CASH";
                orderData.payment_method = "vodafone_cash";
                orderData.phone_number = customerData.phone_number;
                await alert("Payment methods not available now, try cash on delivary.");
                break;

              case "method3": // Instapay
                alert(
                  "Payment via Instapay is currently unavailable. Please choose another payment method."
                );
                throw new Error("Instapay not implemented.");

              default:
                alert("Please choose a valid payment method.");
                throw new Error("Invalid payment method selected.");
            }
          } catch (error) {
            console.error("Payment processing failed:", error.message);
          }
        };

        // prevent duplicate listeners
        btnConfirm.replaceWith(btnConfirm.cloneNode(true));
        const freshConfirm = document.getElementById("btnConfirm");
        freshConfirm.addEventListener("click", onConfirm, { once: true });
      });
    });
  </script>
</body>

</html>